<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta property="og:title" content="Search Similar 3D Meshes" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://docs.jina.ai/datatype/mesh/mesh-search/" />
<meta property="og:site_name" content="Jina 3.0.0 Documentation" />
<meta property="og:description" content="In this tutorial, we will learn how to build a 3D mesh search pipeline with Jina. In particular, we will be building a search pipeline for 3D models in GLB format. Just like other data types, the 3D meshes search pipeline consists of loading, encoding and indexing the data. We can search the data..." />
<meta property="og:image" content="https://docs.jina.ai/_images/flow.png" />
<meta property="og:image:alt" content="Jina 3.0.0 Documentation" />
<meta name="description" content="In this tutorial, we will learn how to build a 3D mesh search pipeline with Jina. In particular, we will be building a search pipeline for 3D models in GLB format. Just like other data types, the 3D meshes search pipeline consists of loading, encoding and indexing the data. We can search the data..." />
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@JinaAI_">
<meta name="twitter:creator" content="@JinaAI_">
<meta name="description" content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">
<meta property="og:description" content="Jina is the cloud-native neural search solution powered by the state-of-the-art AI and deep learning">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-48ZDWC8GT6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-48ZDWC8GT6');
</script>

<script async defer src="https://buttons.github.io/buttons.js"></script>
<script async defer src="https://cdn.jsdelivr.net/npm/qabot@0.3"></script>
    
<link rel="index" title="Index" href="../../../genindex/" /><link rel="search" title="Search" href="../../../search/" />
        <link rel="canonical" href="https://docs.jina.ai/datatype/mesh/mesh-search.html" />

    <link rel="shortcut icon" href="../../../_static/favicon.ico"/><!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Search Similar 3D Meshes - Jina 3.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/docbot.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: #4d4d4d;
  --color-brand-primary: #009191;
  --color-brand-content: #009191;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #FBCB67;
  --color-brand-content: #FBCB67;
  
      }
    }
  }
</style></head>
  <body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
    <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
    <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
    <header class="mobile-header" id="mobile-header">
        <div class="header-left">
            <label class="nav-overlay-icon" for="__navigation">
                <div class="visually-hidden">Toggle site navigation sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-menu"></use>
                    </svg>
                </i>
            </label>
        </div>
        <div class="header-center">
            <a href="../../../">
                <div class="brand">Jina 3.0.0 documentation</div>
            </a>
        </div>
        <div class="header-right">
            <div class="theme-toggle-container theme-toggle-header">
                <button class="theme-toggle">
                    <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                    <svg class="theme-icon-when-auto">
                        <use href="#svg-sun-half"></use>
                    </svg>
                    <svg class="theme-icon-when-dark">
                        <use href="#svg-moon"></use>
                    </svg>
                    <svg class="theme-icon-when-light">
                        <use href="#svg-sun"></use>
                    </svg>
                </button>
            </div>
            <label class="toc-overlay-icon toc-header-icon" for="__toc">
                <div class="visually-hidden">Toggle table of contents sidebar</div>
                <i class="icon">
                    <svg>
                        <use href="#svg-toc"></use>
                    </svg>
                </i>
            </label>
        </div>
    </header>
    <aside class="sidebar-drawer" id="sidebar-drawer">
        <div class="sidebar-container">
            
            <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../../_static/logo-light.svg" alt="Light Logo" />
    <img class="sidebar-logo only-dark" src="../../../_static/logo-dark.svg" alt="Dark Logo" />
  </div>
  
  
</a>
<script>
  function setPrefix(prefix){
    window.location.href = prefix
  }
</script>
<script defer>
  fetch(`https://${window.location.host}/_versions.json`)
  .then((resp) => resp.json())
  .then((data) => {
    var versionSelector = document.getElementsByClassName("version-select")[0];
    var currentPrefix = window.location.href.toString().split(window.location.host)[1].split('/')[1];

    for(var i = 0; i < data.length; i++){
      var option = document.createElement("option");
      option.innerHTML = data[i].version;
      option.value = "/" + data[i].version;
      versionSelector.appendChild(option);
      if(currentPrefix === data[i].version){
        versionSelector.selectedIndex = i + 1;
      }
    }
  })
  .catch((err) => console.log(err));
</script>
<div class="sd-d-flex-row sd-align-major-spaced">
  <a class="github-button" href="https://github.com/jina-ai/jina" data-icon="octicon-star" data-show-count="true" aria-label="Star jina-ai/jina on GitHub" style="opacity: 0;">Star</a>
  <select onChange="setPrefix(this.value)" class="version-select">
    <option value="/">latest</option>
  </select>
</div><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
    <p class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/neural-search/">What is Neural Search?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/what-is-jina/">What is Jina?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/what-is-jina/#comparing-to-alternatives">Comparing to Alternatives</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../get-started/install/">Install</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../get-started/install/windows/">Jina on Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get-started/install/troubleshooting/">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/create-app/">Create a New Project</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../get-started/hello-world/">Run Quick Demos</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../get-started/hello-world/fashion/">Fashion image search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get-started/hello-world/covid-19-chatbot/">Covid-19 chatbot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../get-started/hello-world/multimodal/">Multimodal search</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentals/architecture-overview/">Architecture Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../fundamentals/executor/">Executor</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/executor/executor-api/">Executor API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/executor/executor-in-flow/">Executors inside a Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/executor/repository-structure/">Executor File Structure</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../fundamentals/executor/hub/">Share Executors via Jina Hub</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../fundamentals/executor/hub/hub-portal/">Hub Portal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fundamentals/executor/hub/create-hub-executor/">Create Executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fundamentals/executor/hub/push-executor/">Publish Executor</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fundamentals/executor/hub/use-hub-executor/">Use Hub Executors Locally</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../how-to/sandbox/">Use Hub Executor Remotely</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../fundamentals/executor/hub/executor-best-practices/">Best Practices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/executor/containerize-executor/">Dockerize your Executor</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../fundamentals/flow/">Flow</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/flow/create-flow/">Create a Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/flow/flow-api/">Flow API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/flow/client/">Jina Python Client</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentals/flow/remarks/">Remarks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../fundamentals/clean-code/">Clean &amp; Efficient Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How-to</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../how-to/deploy/">Deploy</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../how-to/docker-compose/">How to run Jina with Docker Compose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../how-to/kubernetes/">How to deploy Jina on Kubernetes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../how-to/executor/">Executor</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../how-to/async-executors/">How to use async coroutines in Executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../how-to/scale-out/">How to Scale Out Your Executor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../how-to/gpu-executor/">How to run Executors on GPU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../how-to/external-executor/">How to use external Executors</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../get-started/migrate/">Migration to Jina 3</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../api/">Python API</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/jina/">jina package</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.clients/">jina.clients package</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.clients.base/">jina.clients.base package</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.clients.base.grpc/">jina.clients.base.grpc module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.clients.base.helper/">jina.clients.base.helper module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.clients.base.http/">jina.clients.base.http module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.clients.base.websocket/">jina.clients.base.websocket module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.clients.request/">jina.clients.request package</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.clients.request.asyncio/">jina.clients.request.asyncio module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.clients.request.helper/">jina.clients.request.helper module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.clients.grpc/">jina.clients.grpc module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.clients.helper/">jina.clients.helper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.clients.http/">jina.clients.http module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.clients.mixin/">jina.clients.mixin module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.clients.websocket/">jina.clients.websocket module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.helloworld/">jina.helloworld package</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.helloworld.chatbot/">jina.helloworld.chatbot package</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.helloworld.chatbot.app/">jina.helloworld.chatbot.app module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.helloworld.chatbot.my_executors/">jina.helloworld.chatbot.my_executors module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.helloworld.fashion/">jina.helloworld.fashion package</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.helloworld.fashion.app/">jina.helloworld.fashion.app module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.helloworld.fashion.helper/">jina.helloworld.fashion.helper module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.helloworld.fashion.my_executors/">jina.helloworld.fashion.my_executors module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.helloworld.multimodal/">jina.helloworld.multimodal package</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.helloworld.multimodal.app/">jina.helloworld.multimodal.app module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.helloworld.multimodal.my_executors/">jina.helloworld.multimodal.my_executors module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.helloworld.fork/">jina.helloworld.fork module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.hubble/">jina.hubble package</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.hubble.helper/">jina.hubble.helper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.hubble.hubapi/">jina.hubble.hubapi module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.hubble.hubio/">jina.hubble.hubio module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.jaml/">jina.jaml package</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers/">jina.jaml.parsers package</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers.default/">jina.jaml.parsers.default package</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.jaml.parsers.default.v1/">jina.jaml.parsers.default.v1 module</a></li>
</ul>
</li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers.executor/">jina.jaml.parsers.executor package</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.jaml.parsers.executor.legacy/">jina.jaml.parsers.executor.legacy module</a></li>
</ul>
</li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.jaml.parsers.flow/">jina.jaml.parsers.flow package</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.jaml.parsers.flow.v1/">jina.jaml.parsers.flow.v1 module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.jaml.parsers.base/">jina.jaml.parsers.base module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.jaml.helper/">jina.jaml.helper module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.logging/">jina.logging package</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.logging.formatter/">jina.logging.formatter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.logging.logger/">jina.logging.logger module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.logging.predefined/">jina.logging.predefined module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.logging.profile/">jina.logging.profile module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.orchestrate/">jina.orchestrate package</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.orchestrate.deployments/">jina.orchestrate.deployments package</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.orchestrate.deployments.config/">jina.orchestrate.deployments.config package</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6 has-children"><a class="reference internal" href="../../../api/jina.orchestrate.deployments.config.k8slib/">jina.orchestrate.deployments.config.k8slib package</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../api/jina.orchestrate.deployments.config.k8slib.kubernetes_deployment/">jina.orchestrate.deployments.config.k8slib.kubernetes_deployment module</a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../api/jina.orchestrate.deployments.config.k8slib.kubernetes_tools/">jina.orchestrate.deployments.config.k8slib.kubernetes_tools module</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.orchestrate.deployments.config.docker_compose/">jina.orchestrate.deployments.config.docker_compose module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.orchestrate.deployments.config.helper/">jina.orchestrate.deployments.config.helper module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.orchestrate.deployments.config.k8s/">jina.orchestrate.deployments.config.k8s module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.orchestrate.flow/">jina.orchestrate.flow package</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.flow.asyncio/">jina.orchestrate.flow.asyncio module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.flow.base/">jina.orchestrate.flow.base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.flow.builder/">jina.orchestrate.flow.builder module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.orchestrate.pods/">jina.orchestrate.pods package</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.pods.container/">jina.orchestrate.pods.container module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.pods.container_helper/">jina.orchestrate.pods.container_helper module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.pods.factory/">jina.orchestrate.pods.factory module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.pods.helper/">jina.orchestrate.pods.helper module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.orchestrate.pods.jinad/">jina.orchestrate.pods.jinad module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.parsers/">jina.parsers package</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.parsers.hubble/">jina.parsers.hubble package</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.parsers.hubble.new/">jina.parsers.hubble.new module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.parsers.hubble.pull/">jina.parsers.hubble.pull module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.parsers.hubble.push/">jina.parsers.hubble.push module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.parsers.orchestrate/">jina.parsers.orchestrate package</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.runtimes/">jina.parsers.orchestrate.runtimes package</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.runtimes.container/">jina.parsers.orchestrate.runtimes.container module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.runtimes.distributed/">jina.parsers.orchestrate.runtimes.distributed module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.runtimes.head/">jina.parsers.orchestrate.runtimes.head module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.runtimes.remote/">jina.parsers.orchestrate.runtimes.remote module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.runtimes.worker/">jina.parsers.orchestrate.runtimes.worker module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.base/">jina.parsers.orchestrate.base module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.deployment/">jina.parsers.orchestrate.deployment module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.parsers.orchestrate.pod/">jina.parsers.orchestrate.pod module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.base/">jina.parsers.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.client/">jina.parsers.client module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.create/">jina.parsers.create module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.deprecated/">jina.parsers.deprecated module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.export_api/">jina.parsers.export_api module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.flow/">jina.parsers.flow module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.helloworld/">jina.parsers.helloworld module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.helper/">jina.parsers.helper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.parsers.ping/">jina.parsers.ping module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.proto/">jina.proto package</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.proto.jina_pb2/">jina.proto.jina_pb2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.proto.jina_pb2_grpc/">jina.proto.jina_pb2_grpc module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.proto.serializer/">jina.proto.serializer module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.schemas/">jina.schemas package</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.schemas.deployment/">jina.schemas.deployment module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.schemas.executor/">jina.schemas.executor module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.schemas.flow/">jina.schemas.flow module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.schemas.helper/">jina.schemas.helper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.schemas.meta/">jina.schemas.meta module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.serve/">jina.serve package</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.serve.executors/">jina.serve.executors package</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.serve.executors.decorators/">jina.serve.executors.decorators module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.serve.executors.metas/">jina.serve.executors.metas module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.serve.runtimes/">jina.serve.runtimes package</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway/">jina.serve.runtimes.gateway package</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6 has-children"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.graph/">jina.serve.runtimes.gateway.graph package</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.graph.topology_graph/">jina.serve.runtimes.gateway.graph.topology_graph module</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.grpc/">jina.serve.runtimes.gateway.grpc package</a></li>
<li class="toctree-l6 has-children"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.http/">jina.serve.runtimes.gateway.http package</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.http.app/">jina.serve.runtimes.gateway.http.app module</a></li>
<li class="toctree-l7"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.http.models/">jina.serve.runtimes.gateway.http.models module</a></li>
</ul>
</li>
<li class="toctree-l6 has-children"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.websocket/">jina.serve.runtimes.gateway.websocket package</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.websocket.app/">jina.serve.runtimes.gateway.websocket.app module</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.serve.runtimes.gateway.request_handling/">jina.serve.runtimes.gateway.request_handling module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.serve.runtimes.head/">jina.serve.runtimes.head package</a></li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/jina.serve.runtimes.request_handlers/">jina.serve.runtimes.request_handlers package</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/jina.serve.runtimes.request_handlers.data_request_handler/">jina.serve.runtimes.request_handlers.data_request_handler module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.serve.runtimes.worker/">jina.serve.runtimes.worker package</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.serve.runtimes.asyncio/">jina.serve.runtimes.asyncio module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.serve.runtimes.base/">jina.serve.runtimes.base module</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.serve.stream/">jina.serve.stream package</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.serve.stream.helper/">jina.serve.stream.helper module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.serve.networking/">jina.serve.networking module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/jina.types/">jina.types package</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/jina.types.request/">jina.types.request package</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.types.request.control/">jina.types.request.control module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/jina.types.request.data/">jina.types.request.data module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/jina.types.mixin/">jina.types.mixin module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.checker/">jina.checker module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.enums/">jina.enums module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.excepts/">jina.excepts module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.helper/">jina.helper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/jina.importer/">jina.importer module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/daemon/">daemon package</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/daemon.api/">daemon.api package</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" role="switch" type="checkbox"/><label for="toctree-checkbox-48"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../../api/daemon.api.endpoints/">daemon.api.endpoints package</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" role="switch" type="checkbox"/><label for="toctree-checkbox-49"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../../../api/daemon.api.endpoints.partial/">daemon.api.endpoints.partial package</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" role="switch" type="checkbox"/><label for="toctree-checkbox-50"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/daemon.api.endpoints.partial.deployment/">daemon.api.endpoints.partial.deployment module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/daemon.api.endpoints.partial.flow/">daemon.api.endpoints.partial.flow module</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/daemon.api.endpoints.partial.pod/">daemon.api.endpoints.partial.pod module</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/daemon.api.endpoints.deployments/">daemon.api.endpoints.deployments module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/daemon.api.endpoints.flows/">daemon.api.endpoints.flows module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/daemon.api.endpoints.logs/">daemon.api.endpoints.logs module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/daemon.api.endpoints.pods/">daemon.api.endpoints.pods module</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../../api/daemon.api.endpoints.workspaces/">daemon.api.endpoints.workspaces module</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.api.dependencies/">daemon.api.dependencies module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/daemon.clients/">daemon.clients package</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" role="switch" type="checkbox"/><label for="toctree-checkbox-51"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.clients.base/">daemon.clients.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.clients.deployments/">daemon.clients.deployments module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.clients.flows/">daemon.clients.flows module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.clients.mixin/">daemon.clients.mixin module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.clients.pods/">daemon.clients.pods module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.clients.workspaces/">daemon.clients.workspaces module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/daemon.models/">daemon.models package</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" role="switch" type="checkbox"/><label for="toctree-checkbox-52"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.base/">daemon.models.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.containers/">daemon.models.containers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.custom/">daemon.models.custom module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.enums/">daemon.models.enums module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.id/">daemon.models.id module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.partial/">daemon.models.partial module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.ports/">daemon.models.ports module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.models.workspaces/">daemon.models.workspaces module</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../api/daemon.stores/">daemon.stores package</a><input class="toctree-checkbox" id="toctree-checkbox-53" name="toctree-checkbox-53" role="switch" type="checkbox"/><label for="toctree-checkbox-53"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.base/">daemon.stores.base module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.containers/">daemon.stores.containers module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.deployments/">daemon.stores.deployments module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.flows/">daemon.stores.flows module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.mixin/">daemon.stores.mixin module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.partial/">daemon.stores.partial module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.pods/">daemon.stores.pods module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/daemon.stores.workspaces/">daemon.stores.workspaces module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/daemon.dockerize/">daemon.dockerize module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/daemon.excepts/">daemon.excepts module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/daemon.files/">daemon.files module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/daemon.helper/">daemon.helper module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/daemon.parser/">daemon.parser module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/daemon.tasks/">daemon.tasks module</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../api/cli/">cli package</a><input class="toctree-checkbox" id="toctree-checkbox-54" name="toctree-checkbox-54" role="switch" type="checkbox"/><label for="toctree-checkbox-54"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/cli.api/">cli.api module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/cli.autocomplete/">cli.autocomplete module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/cli.export/">cli.export module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/cli.lookup/">cli.lookup module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli/">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../proto/docs/">Protocol Documentation</a></li>
</ul>

    <p class="caption" role="heading"><span class="caption-text">Ecosystem</span></p>
    <ul>
        <li class="toctree-l1">
            <a class="reference internal" href="#">
                <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/search-light.svg">
                <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/search-dark.svg">
                Jina</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://hub.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/hub-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/hub-dark.svg">
            Jina Hub</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://finetuner.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/finetuner-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/finetuner-dark.svg">
            Finetuner</a></li>
        <li class="toctree-l1"><a class="reference external" href="https://docarray.jina.ai">
            <img class="sidebar-ecosys-logo only-light-line" src="../../../_static/docarray-light.svg">
            <img class="sidebar-ecosys-logo only-dark-line" src="../../../_static/docarray-dark.svg">
            DocArray</a></li>
    </ul>
</div>

</div>

            </div>
            
        </div>
    </aside>
    <div class="main">
        <div class="content">
            <article role="main">
                <div class="content-icon-container">
                    <div class="theme-toggle-container theme-toggle-content">
                        <button class="theme-toggle">
                            <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
                            <svg class="theme-icon-when-auto">
                                <use href="#svg-sun-half"></use>
                            </svg>
                            <svg class="theme-icon-when-dark">
                                <use href="#svg-moon"></use>
                            </svg>
                            <svg class="theme-icon-when-light">
                                <use href="#svg-sun"></use>
                            </svg>
                        </button>
                    </div>
                    <label class="toc-overlay-icon toc-content-icon"
                           for="__toc">
                        <div class="visually-hidden">Toggle table of contents sidebar</div>
                        <i class="icon">
                            <svg>
                                <use href="#svg-toc"></use>
                            </svg>
                        </i>
                    </label>
                </div>
                <section class="tex2jax_ignore mathjax_ignore" id="search-similar-3d-meshes">
<h1>Search Similar 3D Meshes<a class="headerlink" href="#search-similar-3d-meshes" title="Permalink to this heading">#</a></h1>
<p>In this tutorial, we will learn how to build a 3D mesh search pipeline with Jina. In particular, we will be building a search pipeline for 3D models in GLB format.</p>
<p>Just like other data types, the 3D meshes search pipeline consists of <strong>loading</strong>, <strong>encoding</strong> and <strong>indexing</strong> the data. We can search the data after they are indexed.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading">#</a></h2>
<p>Let’s first install the following PyPI dependencies:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install tensorflow trimesh pyrender
</pre></div>
</div>
</section>
<section id="load-glb-data">
<h2>Load GLB data<a class="headerlink" href="#load-glb-data" title="Permalink to this heading">#</a></h2>
<p>First, given a <code class="docutils literal notranslate"><span class="pre">glb</span></code> file, how do we load and craft the <code class="docutils literal notranslate"><span class="pre">glb</span></code> into a Document so that we can process and encode?  Let’s use <code class="docutils literal notranslate"><span class="pre">trimesh</span></code> to build an executor for this.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">as_mesh</span><span class="p">(</span><span class="n">scene</span><span class="p">:</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">Scene</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scene</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="nb">tuple</span><span class="p">(</span><span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">scene</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>


<span class="k">class</span> <span class="nc">GlbCrafter</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/index&#39;</span><span class="p">,</span> <span class="s1">&#39;/search&#39;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">craft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">load_mesh</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">uri</span><span class="p">)</span>
            <span class="n">d</span><span class="o">.</span><span class="n">blob</span> <span class="o">=</span> <span class="n">as_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
</pre></div>
</div>
<p>We first load the data of each <code class="docutils literal notranslate"><span class="pre">glb</span></code> file as Python object. We will use the <code class="docutils literal notranslate"><span class="pre">trimesh</span></code> package to represents the <code class="docutils literal notranslate"><span class="pre">glb</span></code> data in the form of triangular meshes. The loaded object is of type <code class="docutils literal notranslate"><span class="pre">trimesh.Scene</span></code> which may contain one or more triangular mesh geometries. We combine all the meshes in the <code class="docutils literal notranslate"><span class="pre">Scene</span></code> to create a single <code class="docutils literal notranslate"><span class="pre">Trimesh</span></code> using <code class="docutils literal notranslate"><span class="pre">as_mesh</span></code>. Then we can sample surfaces from a single mesh geometry. The sampled surface will be made from 2048 points in 3D space and hence the shape of the <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> representing each 3D model will be <code class="docutils literal notranslate"><span class="pre">(2048,</span> <span class="pre">3)</span></code>.</p>
</section>
<section id="encode-3d-model">
<h2>Encode 3D Model<a class="headerlink" href="#encode-3d-model" title="Permalink to this heading">#</a></h2>
<p>Once we convert each <code class="docutils literal notranslate"><span class="pre">glb</span></code> model into an <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, encoding the inputs becomes straightforward. We will use our pre-trained <code class="docutils literal notranslate"><span class="pre">pointnet</span></code> to encode the data. The model looks like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="n">ckpt_path</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
    <span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
    <span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>
    
    <span class="k">def</span> <span class="nf">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv1D</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">momentum</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">filters</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">momentum</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">tnet</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">num_features</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">OrthogonalRegularizer</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">regularizers</span><span class="o">.</span><span class="n">Regularizer</span><span class="p">):</span>
            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_features_</span><span class="p">,</span> <span class="n">l2reg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="n">num_features_</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">l2reg</span> <span class="o">=</span> <span class="n">l2reg</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">)</span>
    
            <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">))</span>
                <span class="n">xxt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
                <span class="n">xxt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xxt</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l2reg</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">xxt</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="p">))</span>
    
            <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;num_features&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span>
                        <span class="s1">&#39;l2reg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2reg</span><span class="p">,</span>
                        <span class="s1">&#39;eye&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">numpy</span><span class="p">()}</span>
    
        <span class="n">bias</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_features</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">OrthogonalRegularizer</span><span class="p">(</span><span class="n">num_features</span><span class="p">)</span>
    
        <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">GlobalMaxPooling1D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
            <span class="n">num_features</span> <span class="o">*</span> <span class="n">num_features</span><span class="p">,</span>
            <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span>
            <span class="n">bias_initializer</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
            <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">reg</span><span class="p">,</span>
        <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">feat_T</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_features</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))([</span><span class="n">inputs</span><span class="p">,</span> <span class="n">feat_T</span><span class="p">])</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tnet</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tnet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">GlobalMaxPooling1D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pointnet&#39;</span><span class="p">)</span>
    <span class="n">intermediate_layer_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">input</span><span class="p">,</span>
                                           <span class="n">outputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;dense_1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>
    <span class="n">intermediate_layer_model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">ckpt_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">intermediate_layer_model</span>
</pre></div>
</div>
<p>With the above model, we can then build our <code class="docutils literal notranslate"><span class="pre">pointnet</span></code> executor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PNEncoder</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedding_model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="n">ckpt_path</span><span class="o">=</span><span class="n">ckpt_path</span><span class="p">)</span>

    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/index&#39;</span><span class="p">,</span> <span class="s1">&#39;/search&#39;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">docs</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">docs</span><span class="o">.</span><span class="n">blobs</span><span class="p">)</span>
</pre></div>
</div>
<div class="info admonition">
<p class="admonition-title">Tips</p>
<p>Instead of iterating over each doc to set its embedding, we can directly get the blobs of all docs in <code class="docutils literal notranslate"><span class="pre">docs</span></code> at once by using the attribute <code class="docutils literal notranslate"><span class="pre">blobs</span></code> and set the embeddings of all docs in <code class="docutils literal notranslate"><span class="pre">docs</span></code> at once by using the attribute <code class="docutils literal notranslate"><span class="pre">embeddings</span></code>.</p>
</div>
</section>
<section id="index-the-data">
<h2>Index the data<a class="headerlink" href="#index-the-data" title="Permalink to this heading">#</a></h2>
<p>Let’s also build an indexer to index the data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyIndexer</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="n">_docs</span> <span class="o">=</span> <span class="n">DocumentArray</span><span class="p">()</span>

    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;/index&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_docs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>

    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;/search&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">docs</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docs</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>The above indexer simply uses <code class="docutils literal notranslate"><span class="pre">DocumentArray</span></code> to store all the index docs and leverages the <code class="docutils literal notranslate"><span class="pre">match</span></code> function of <code class="docutils literal notranslate"><span class="pre">DocumentArray</span></code> to match the query with docs indexed.</p>
</section>
<section id="visualize-3d-model">
<h2>Visualize 3D Model<a class="headerlink" href="#visualize-3d-model" title="Permalink to this heading">#</a></h2>
<p>Finally, let’s also build the <code class="docutils literal notranslate"><span class="pre">GlbVisualizer</span></code> to visualize the results.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyrender</span>
<span class="kn">import</span> <span class="nn">pyglet</span>
<span class="kn">from</span> <span class="nn">pyglet</span> <span class="kn">import</span> <span class="n">clock</span>
<span class="kn">from</span> <span class="nn">pyglet.gl</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="kn">from</span> <span class="nn">pyrender</span> <span class="kn">import</span> <span class="n">Viewer</span>


<span class="k">def</span> <span class="nf">_init_and_start_app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TARGET_OPEN_GL_MAJOR</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Target OpenGL Major Version</span>
        <span class="n">TARGET_OPEN_GL_MINOR</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">MIN_OPEN_GL_MAJOR</span> <span class="o">=</span> <span class="mi">3</span>     <span class="c1"># Minimum OpenGL Major Version</span>
        <span class="n">MIN_OPEN_GL_MINOR</span> <span class="o">=</span> <span class="mi">3</span>     <span class="c1"># Minimum OpenGL Minor Version</span>
        <span class="n">confs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Config</span><span class="p">(</span><span class="n">sample_buffers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                        <span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">major_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MAJOR</span><span class="p">,</span>
                        <span class="n">minor_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MINOR</span><span class="p">),</span>
                 <span class="n">Config</span><span class="p">(</span><span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">major_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MAJOR</span><span class="p">,</span>
                        <span class="n">minor_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MINOR</span><span class="p">),</span>
                 <span class="n">Config</span><span class="p">(</span><span class="n">sample_buffers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                        <span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">major_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MAJOR</span><span class="p">,</span>
                        <span class="n">minor_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MINOR</span><span class="p">),</span>
                 <span class="n">Config</span><span class="p">(</span><span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
                        <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">major_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MAJOR</span><span class="p">,</span>
                        <span class="n">minor_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MINOR</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">conf</span> <span class="ow">in</span> <span class="n">confs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">(</span><span class="n">Viewer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">conf</span><span class="p">,</span> <span class="n">resizable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_viewport_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                             <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_viewport_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">break</span>
            <span class="k">except</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">NoSuchConfigException</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to initialize an OpenGL 3+ context&#39;</span><span class="p">)</span>

        <span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span>
            <span class="n">Viewer</span><span class="o">.</span><span class="n">_time_event</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer_flags</span><span class="p">[</span><span class="s1">&#39;refresh_rate&#39;</span><span class="p">],</span> <span class="bp">self</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewer_flags</span><span class="p">[</span><span class="s1">&#39;window_title&#39;</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">GlbVisualizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_doc</span> <span class="o">=</span> <span class="n">search_doc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orig_func</span> <span class="o">=</span> <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="o">.</span><span class="n">_init_and_start_app</span>
        <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="o">.</span><span class="n">_init_and_start_app</span> <span class="o">=</span> <span class="n">_init_and_start_app</span>

    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_doc</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span> <span class="s1">&#39;Query Doc&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> Match&#39;</span><span class="p">)</span>
        <span class="n">pyglet</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">fuze_trimesh</span> <span class="o">=</span> <span class="n">as_mesh</span><span class="p">(</span><span class="n">trimesh</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">uri</span><span class="p">))</span>
        <span class="n">mesh</span> <span class="o">=</span> <span class="n">pyrender</span><span class="o">.</span><span class="n">Mesh</span><span class="o">.</span><span class="n">from_trimesh</span><span class="p">(</span><span class="n">fuze_trimesh</span><span class="p">)</span>
        <span class="n">scene</span> <span class="o">=</span> <span class="n">pyrender</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>
        <span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span>

        <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="p">(</span>
            <span class="n">scene</span><span class="p">,</span>
            <span class="n">use_raymond_lighting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">viewer_flags</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;rotate&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;window_title&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> 
                <span class="s1">&#39;caption&#39;</span><span class="p">:</span> <span class="p">[{</span>
                    <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;OpenSans-Regular&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;font_pt&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
                    <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                    <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                    <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">title</span>
                <span class="p">}]</span>
            <span class="p">},</span>
        <span class="p">)</span>
        
    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="o">.</span><span class="n">_init_and_start_app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_func</span>
</pre></div>
</div>
<p>The visualizer uses <code class="docutils literal notranslate"><span class="pre">pyrender</span></code> to render the query and match results. Since we want to display multiple models at once, we need to patch the <code class="docutils literal notranslate"><span class="pre">_init_and_start_app</span></code> function to delay the start of pyrender app after all viewers are initialized.</p>
</section>
<section id="index-search-and-visualize-data">
<h2>Index, Search and Visualize Data<a class="headerlink" href="#index-search-and-visualize-data" title="Permalink to this heading">#</a></h2>
<p>Download the pre-trained PNEncoder model <a class="reference external" href="https://github.com/jina-ai/example-3D-model/tree/main/executors/pn_encoder/ckpt">here</a> into <code class="docutils literal notranslate"><span class="pre">model/ckpt</span></code>. Also, store the index/search data in <code class="docutils literal notranslate"><span class="pre">data/</span></code>. We can then put the executors into a flow and use the flow to perform indexing and searching. Finally, we use the <code class="docutils literal notranslate"><span class="pre">GlbVisualizer</span></code> built earlier to visualize our data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">Flow</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">GlbCrafter</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">PNEncoder</span><span class="p">,</span> <span class="n">uses_with</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ckpt_path&#39;</span><span class="p">:</span> <span class="s1">&#39;model/ckpt/ckpt_True&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyIndexer</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">from_files</span><span class="p">(</span><span class="s1">&#39;data/*.glb&#39;</span><span class="p">))</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">Document</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="s1">&#39;data/rifle_16.glb&#39;</span><span class="p">),</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">docs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># visualize top 3 matches, since we also index query doc, exclude the top 1 match as it is the query doc</span>
    <span class="n">visualizer</span> <span class="o">=</span> <span class="n">GlbVisualizer</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
<p>This is how the flow we built looks like:</p>
<figure class="align-center">
<img alt="../../../_images/flow.png" src="../../../_images/flow.png" />
</figure>
</section>
<section id="putting-it-all-together">
<h2>Putting it all together<a class="headerlink" href="#putting-it-all-together" title="Permalink to this heading">#</a></h2>
<p>Combining the steps listed above and import the necessary dependencies, the following is the complete code.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Complete source code<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span> <span class="nn">jina</span> <span class="kn">import</span> <span class="n">Flow</span><span class="p">,</span> <span class="n">Executor</span><span class="p">,</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="n">Document</span><span class="p">,</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="nn">jina.types.document.generators</span> <span class="kn">import</span> <span class="n">from_files</span>
<span class="kn">import</span> <span class="nn">trimesh</span>

<span class="kn">import</span> <span class="nn">pyrender</span>
<span class="kn">from</span> <span class="nn">pyrender</span> <span class="kn">import</span> <span class="n">Viewer</span>

<span class="c1"># pyglet dependencies should be imported AFTER pyrender</span>
<span class="kn">import</span> <span class="nn">pyglet</span>
<span class="kn">from</span> <span class="nn">pyglet</span> <span class="kn">import</span> <span class="n">clock</span>
<span class="kn">from</span> <span class="nn">pyglet.gl</span> <span class="kn">import</span> <span class="n">Config</span>


<span class="k">def</span> <span class="nf">as_mesh</span><span class="p">(</span><span class="n">scene</span><span class="p">:</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">Scene</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">scene</span><span class="o">.</span><span class="n">geometry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
        <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">trimesh</span><span class="o">.</span><span class="n">Trimesh</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">scene</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="p">)</span>


<span class="k">class</span> <span class="nc">GlbCrafter</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/index&#39;</span><span class="p">,</span> <span class="s1">&#39;/search&#39;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">craft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">docs</span><span class="p">:</span>
            <span class="n">mesh</span> <span class="o">=</span> <span class="n">trimesh</span><span class="o">.</span><span class="n">load_mesh</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">uri</span><span class="p">)</span>
            <span class="n">d</span><span class="o">.</span><span class="n">blob</span> <span class="o">=</span> <span class="n">as_mesh</span><span class="p">(</span><span class="n">trimesh</span><span class="o">.</span><span class="n">load_mesh</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">uri</span><span class="p">))</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_model</span><span class="p">(</span><span class="n">ckpt_path</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
    <span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
    <span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>

    <span class="k">def</span> <span class="nf">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Conv1D</span><span class="p">(</span><span class="n">filters</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">momentum</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">filters</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">momentum</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tnet</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">num_features</span><span class="p">):</span>
        <span class="k">class</span> <span class="nc">OrthogonalRegularizer</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">regularizers</span><span class="o">.</span><span class="n">Regularizer</span><span class="p">):</span>
            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_features_</span><span class="p">,</span> <span class="n">l2reg</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="n">num_features_</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">l2reg</span> <span class="o">=</span> <span class="n">l2reg</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eye</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">)</span>

            <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">))</span>
                <span class="n">xxt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">tensordot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
                <span class="n">xxt</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xxt</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l2reg</span> <span class="o">*</span> <span class="n">tf</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">xxt</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="p">))</span>

            <span class="k">def</span> <span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span>
                    <span class="s1">&#39;num_features&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span>
                    <span class="s1">&#39;l2reg&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">l2reg</span><span class="p">,</span>
                    <span class="s1">&#39;eye&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">eye</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span>
                <span class="p">}</span>

        <span class="n">bias</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_features</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="n">reg</span> <span class="o">=</span> <span class="n">OrthogonalRegularizer</span><span class="p">(</span><span class="n">num_features</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">GlobalMaxPooling1D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
            <span class="n">num_features</span> <span class="o">*</span> <span class="n">num_features</span><span class="p">,</span>
            <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span>
            <span class="n">bias_initializer</span><span class="o">=</span><span class="n">bias</span><span class="p">,</span>
            <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">reg</span><span class="p">,</span>
        <span class="p">)(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">feat_T</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Reshape</span><span class="p">((</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_features</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dot</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))([</span><span class="n">inputs</span><span class="p">,</span> <span class="n">feat_T</span><span class="p">])</span>

    <span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tnet</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">tnet</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">conv_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">GlobalMaxPooling1D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">dense_bn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;pointnet&#39;</span><span class="p">)</span>
    <span class="n">intermediate_layer_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
        <span class="n">inputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">input</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">get_layer</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;dense_1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">output</span>
    <span class="p">)</span>
    <span class="n">intermediate_layer_model</span><span class="o">.</span><span class="n">load_weights</span><span class="p">(</span><span class="n">ckpt_path</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">intermediate_layer_model</span>


<span class="k">class</span> <span class="nc">PNEncoder</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ckpt_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embedding_model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span><span class="n">ckpt_path</span><span class="o">=</span><span class="n">ckpt_path</span><span class="p">)</span>

    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;/index&#39;</span><span class="p">,</span> <span class="s1">&#39;/search&#39;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">docs</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">docs</span><span class="o">.</span><span class="n">blobs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MyIndexer</span><span class="p">(</span><span class="n">Executor</span><span class="p">):</span>
    <span class="n">_docs</span> <span class="o">=</span> <span class="n">DocumentArray</span><span class="p">()</span>

    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;/index&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_docs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">docs</span><span class="p">)</span>

    <span class="nd">@requests</span><span class="p">(</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;/search&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docs</span><span class="p">:</span> <span class="n">DocumentArray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">docs</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_docs</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_init_and_start_app</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">TARGET_OPEN_GL_MAJOR</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Target OpenGL Major Version</span>
    <span class="n">TARGET_OPEN_GL_MINOR</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">MIN_OPEN_GL_MAJOR</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Minimum OpenGL Major Version</span>
    <span class="n">MIN_OPEN_GL_MINOR</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Minimum OpenGL Minor Version</span>
    <span class="n">confs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Config</span><span class="p">(</span>
            <span class="n">sample_buffers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
            <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">major_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MAJOR</span><span class="p">,</span>
            <span class="n">minor_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MINOR</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">Config</span><span class="p">(</span>
            <span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
            <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">major_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MAJOR</span><span class="p">,</span>
            <span class="n">minor_version</span><span class="o">=</span><span class="n">TARGET_OPEN_GL_MINOR</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">Config</span><span class="p">(</span>
            <span class="n">sample_buffers</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
            <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">major_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MAJOR</span><span class="p">,</span>
            <span class="n">minor_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MINOR</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">Config</span><span class="p">(</span>
            <span class="n">depth_size</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span>
            <span class="n">double_buffer</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">major_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MAJOR</span><span class="p">,</span>
            <span class="n">minor_version</span><span class="o">=</span><span class="n">MIN_OPEN_GL_MINOR</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">conf</span> <span class="ow">in</span> <span class="n">confs</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">Viewer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
                <span class="n">config</span><span class="o">=</span><span class="n">conf</span><span class="p">,</span>
                <span class="n">resizable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_viewport_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_viewport_size</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">break</span>
        <span class="k">except</span> <span class="n">pyglet</span><span class="o">.</span><span class="n">window</span><span class="o">.</span><span class="n">NoSuchConfigException</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unable to initialize an OpenGL 3+ context&#39;</span><span class="p">)</span>

    <span class="n">clock</span><span class="o">.</span><span class="n">schedule_interval</span><span class="p">(</span>
        <span class="n">Viewer</span><span class="o">.</span><span class="n">_time_event</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">viewer_flags</span><span class="p">[</span><span class="s1">&#39;refresh_rate&#39;</span><span class="p">],</span> <span class="bp">self</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">switch_to</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewer_flags</span><span class="p">[</span><span class="s1">&#39;window_title&#39;</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">GlbVisualizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">search_doc</span><span class="p">,</span> <span class="n">matches</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">search_doc</span> <span class="o">=</span> <span class="n">search_doc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matches</span> <span class="o">=</span> <span class="n">matches</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orig_func</span> <span class="o">=</span> <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="o">.</span><span class="n">_init_and_start_app</span>
        <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="o">.</span><span class="n">_init_and_start_app</span> <span class="o">=</span> <span class="n">_init_and_start_app</span>

    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">search_doc</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span> <span class="s1">&#39;Query Doc&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">match</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matches</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">uri</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Top </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> Match&#39;</span><span class="p">)</span>
        <span class="n">pyglet</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">scene</span> <span class="o">=</span> <span class="n">pyrender</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>
        <span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">pyrender</span><span class="o">.</span><span class="n">Mesh</span><span class="o">.</span><span class="n">from_trimesh</span><span class="p">(</span><span class="n">as_mesh</span><span class="p">(</span><span class="n">trimesh</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">uri</span><span class="p">))))</span>

        <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="p">(</span>
            <span class="n">scene</span><span class="p">,</span>
            <span class="n">use_raymond_lighting</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">viewer_flags</span><span class="o">=</span><span class="p">{</span>
                <span class="s1">&#39;rotate&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;window_title&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
                <span class="s1">&#39;caption&#39;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;OpenSans-Regular&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;font_pt&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
                        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
                        <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                        <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">],</span>
            <span class="p">},</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">pyrender</span><span class="o">.</span><span class="n">Viewer</span><span class="o">.</span><span class="n">_init_and_start_app</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">orig_func</span>


<span class="k">with</span> <span class="n">Flow</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">GlbCrafter</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">PNEncoder</span><span class="p">,</span> <span class="n">uses_with</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ckpt_path&#39;</span><span class="p">:</span> <span class="s1">&#39;model/ckpt/ckpt_True&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">uses</span><span class="o">=</span><span class="n">MyIndexer</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">from_files</span><span class="p">(</span><span class="s1">&#39;data/*.glb&#39;</span><span class="p">))</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">Document</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="s1">&#39;data/rifle_16.glb&#39;</span><span class="p">),</span> <span class="n">return_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">doc</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">docs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">visualizer</span> <span class="o">=</span> <span class="n">GlbVisualizer</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">matches</span><span class="o">=</span><span class="n">doc</span><span class="o">.</span><span class="n">matches</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details><div class="warning admonition">
<p class="admonition-title">Import warning</p>
<p>Note, <code class="docutils literal notranslate"><span class="pre">pyrender</span></code> has to be imported before all <code class="docutils literal notranslate"><span class="pre">pyglet</span></code> dependencies, otherwise an error will be raised in some os environments such as Mac OS.</p>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this heading">#</a></h2>
<p>Now let’s take a look at the search results! Below is the <code class="docutils literal notranslate"><span class="pre">rifle_16.glb</span></code> 3D model we would like to search for:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../../_images/query_doc.gif"><img alt="../../../_images/query_doc.gif" src="../../../_images/query_doc.gif" style="width: 330.0px; height: 242.00000000000003px;" /></a>
</figure>
<p>And the following are the top 3 matches:</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../../_images/top_1.gif"><img alt="../../../_images/top_1.gif" src="../../../_images/top_1.gif" style="width: 330.0px; height: 242.00000000000003px;" /></a>
</figure>
<figure class="align-center">
<a class="reference internal image-reference" href="../../../_images/top_2.gif"><img alt="../../../_images/top_2.gif" src="../../../_images/top_2.gif" style="width: 330.0px; height: 242.00000000000003px;" /></a>
</figure>
<figure class="align-center">
<a class="reference internal image-reference" href="../../../_images/top_3.gif"><img alt="../../../_images/top_3.gif" src="../../../_images/top_3.gif" style="width: 330.0px; height: 242.00000000000003px;" /></a>
</figure>
<p><strong>Congratulations!</strong> You have just built a 3D Mesh Search Pipeline!</p>
</section>
</section>

            </article>
            <footer>
                
                <div class="related-pages">
                    
                    
                </div>

                <div class="related-information sd-d-inline-flex">
                    <a href="https://jina.ai">Copyright &#169; Jina AI Limited. All rights reserved.</a>
                    Last updated on Dec 14, 2022.
                    <div class="social-btns">
                    <a class='social-btn' href="https://github.com/jina-ai/jina/" aria-label="GitHub" target="_blank" rel="noreferrer"> <i class="fab fa-github"></i></a>
                    <a class='social-btn' href="https://slack.jina.ai" aria-label="Slack" target="_blank" rel="noreferrer"> <i class="fab fa-slack"></i></a>
                    <a class='social-btn' href="https://youtube.com/c/jina-ai" aria-label="YouTube" target="_blank" rel="noreferrer"> <i class="fab fa-youtube"></i></a>
                    <a class='social-btn' href="https://twitter.com/JinaAI_" aria-label="Twitter" target="_blank" rel="noreferrer"> <i class="fab fa-twitter"></i></a>
                    <a class='social-btn' href="https://www.linkedin.com/company/jinaai/" aria-label="LinkedIn" target="_blank" rel="noreferrer"> <i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
                
            </footer>
        </div>
        <aside class="toc-drawer" id="toc-drawer">
            

            <div class="toc-sticky toc-scroll">
                
                <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
                </div>
                <div class="toc-tree-container">
                    <div class="toc-tree">
                        <ul>
<li><a class="reference internal" href="#">Search Similar 3D Meshes</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#load-glb-data">Load GLB data</a></li>
<li><a class="reference internal" href="#encode-3d-model">Encode 3D Model</a></li>
<li><a class="reference internal" href="#index-the-data">Index the data</a></li>
<li><a class="reference internal" href="#visualize-3d-model">Visualize 3D Model</a></li>
<li><a class="reference internal" href="#index-search-and-visualize-data">Index, Search and Visualize Data</a></li>
<li><a class="reference internal" href="#putting-it-all-together">Putting it all together</a></li>
<li><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>

                    </div>
                </div>
                
                <qa-bot
                    style="position: fixed; width: 15em;"
                    theme="follow"
                    animate-by="position"
                >
                    <dt>You can ask questions about our docs. Try:</dt>
                    <dd>Does Jina support Kubernetes?</dd>
                    <dd>How can I traverse a nested DocumentArray?</dd>
                    <dd>What are the basic concepts in Jina?</dd>
                </qa-bot>
            </div>

            
        </aside>

    </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/tabs.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() { 
            document.querySelector("qa-bot").setAttribute("server", "https://jina-ai-jina-docsqa.jina.ai");
        });
        </script>
    </body>
</html>